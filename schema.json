{
  "tables": {
    "user": {
      "columns": {
        "user_id": "BIGINT PRIMARY KEY AUTO_INCREMENT",
        "phone": "VARCHAR(20) UNIQUE NOT NULL",
        "password_hash": "VARCHAR(255) NOT NULL",
        "name": "VARCHAR(150) NOT NULL",
        "avatar_url": "TEXT",
        "role": "ENUM('CUSTOMER','RIDER','ADMIN') DEFAULT 'CUSTOMER'",
        "vehicle_photo_url": "TEXT (nullable, only RIDER)",
        "license_plate": "VARCHAR(32) UNIQUE (nullable, only RIDER)",
        "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
        "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE"
      }
    },
    "address": {
      "columns": {
        "address_id": "BIGINT PRIMARY KEY AUTO_INCREMENT",
        "user_id": "BIGINT FK → user.user_id",
        "label": "VARCHAR(80)",
        "address_line": "TEXT",
        "lat": "DECIMAL(10,7)",
        "lng": "DECIMAL(10,7)",
        "is_default": "BOOLEAN DEFAULT 0",
        "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
        "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE"
      }
    },
    "delivery": {
      "columns": {
        "delivery_id": "BIGINT PRIMARY KEY AUTO_INCREMENT",
        "sender_id": "BIGINT FK → user.user_id",
        "receiver_id": "BIGINT FK → user.user_id",
        "pickup_address_id": "BIGINT FK → address.address_id",
        "dropoff_address_id": "BIGINT FK → address.address_id",
        "status": "ENUM('WAITING','ASSIGNED','ON_ROUTE','DELIVERED')",
        "requested_at": "DATETIME DEFAULT CURRENT_TIMESTAMP",
        "assigned_at": "DATETIME",
        "picked_at": "DATETIME",
        "delivered_at": "DATETIME",
        "note": "TEXT",
        "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
        "updated_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE"
      }
    },
    "delivery_item": {
      "columns": {
        "item_id": "BIGINT PRIMARY KEY AUTO_INCREMENT",
        "delivery_id": "BIGINT FK → delivery.delivery_id",
        "name": "VARCHAR(150)",
        "description": "TEXT",
        "weight_kg": "DECIMAL(8,3)",
        "qty": "INT UNSIGNED DEFAULT 1"
      }
    },
    "delivery_photo": {
      "columns": {
        "photo_id": "BIGINT PRIMARY KEY AUTO_INCREMENT",
        "delivery_id": "BIGINT FK → delivery.delivery_id",
        "status_code": "ENUM('REQUESTED','PICKED_UP','DELIVERED')",
        "uploaded_by": "ENUM('SENDER','RIDER')",
        "photo_url": "TEXT",
        "created_at": "TIMESTAMP DEFAULT CURRENT_TIMESTAMP"
      }
    },
    "rider_assignment": {
      "columns": {
        "assignment_id": "BIGINT PRIMARY KEY AUTO_INCREMENT",
        "delivery_id": "BIGINT FK → delivery.delivery_id (UNIQUE)",
        "user_id": "BIGINT FK → user.user_id (role=RIDER)",
        "state": "ENUM('ASSIGNED','PICKED','COMPLETED','CANCELLED')",
        "accepted_at": "DATETIME",
        "picked_at": "DATETIME",
        "completed_at": "DATETIME",
        "active_flag": "GENERATED TINYINT (1 if ASSIGNED/PICKED)"
      }
    },
    "rider_location": {
      "columns": {
        "location_id": "BIGINT PRIMARY KEY AUTO_INCREMENT",
        "user_id": "BIGINT FK → user.user_id (role=RIDER)",
        "delivery_id": "BIGINT FK → delivery.delivery_id (nullable)",
        "lat": "DECIMAL(10,7)",
        "lng": "DECIMAL(10,7)",
        "recorded_at": "DATETIME DEFAULT CURRENT_TIMESTAMP"
      }
    }
  }
}
